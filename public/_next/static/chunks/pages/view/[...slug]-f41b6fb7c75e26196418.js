(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[165,179],{2137:function(n,e,t){"use strict";function r(n,e,t,r,c,o,u){try{var s=n[o](u),a=s.value}catch(i){return void t(i)}s.done?e(a):Promise.resolve(a).then(r,c)}function c(n){return function(){var e=this,t=arguments;return new Promise((function(c,o){var u=n.apply(e,t);function s(n){r(u,c,o,s,a,"next",n)}function a(n){r(u,c,o,s,a,"throw",n)}s(void 0)}))}}t.d(e,{Z:function(){return c}})},2484:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return i}});var r=t(5893),c=t(7757),o=t.n(c),u=t(2137),s=t(1163),a=t(7294);function i(){var n=(0,s.useRouter)().query.slug,e=(0,a.useState)(null),t=e[0],c=e[1],i=(0,a.useState)(null),f=i[0],d=i[1],p=(0,a.useState)(null),l=(p[0],p[1]),v=null;return"object"===typeof n&&(v=n.join("/")),(0,a.useEffect)((function(){(0,u.Z)(o().mark((function n(){var e,t;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(v){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,fetch("https://us-central1-vaccinepassport-dev.cloudfunctions.net/getTicket"+"?image=".concat(encodeURIComponent(v)),{method:"POST"});case 4:return e=n.sent,n.next=7,e.json();case 7:(t=n.sent).error?l(t.error):c(t);case 9:case"end":return n.stop()}}),n)})))()}),[v]),(0,a.useEffect)((function(){if(v){var n=function(){var e=(0,u.Z)(o().mark((function e(){var r,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=9;break}return e.next=3,fetch("https://us-central1-vaccinepassport-dev.cloudfunctions.net/canAccessImage"+"?image=".concat(encodeURIComponent(v),"&hash=").concat(encodeURIComponent(t.hash)));case 3:return r=e.sent,e.next=6,r.json();case 6:c=e.sent,d(c.approved),"not yet"===c.approved&&setTimeout(n,5e3);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();n()}}),[v,t]),v?t?(0,r.jsxs)("div",{children:[(!f||"not yet"===f)&&t&&(0,r.jsxs)("div",{children:["Your code: ",t.code]}),f&&"invalid ticket"===f&&(0,r.jsx)("div",{children:"Please rescan the QR code"}),f&&"approved"===f&&(0,r.jsx)("img",{src:"https://us-central1-vaccinepassport-dev.cloudfunctions.net/downloadImage"+"?image=".concat(encodeURIComponent(v),"&hash=").concat(encodeURIComponent(t.hash))})]}):(0,r.jsx)("div",{children:"Loading..."}):null}},8826:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/view/[...slug]",function(){return t(2484)}])},1163:function(n,e,t){n.exports=t(2441)},4453:function(){}},function(n){n.O(0,[774,351,433],(function(){return e=8826,n(n.s=e);var e}));var e=n.O();_N_E=e}]);